cargo-features = ["resolver", "named-profiles", "workspace-inheritance"]

[workspace]
members = [
    "build/*",
    "sys/*",
    "lib/*",
    "app/*",
    "task/*",
    "drv/*",
    "test/*",

    "stage0",
]
default-members = []
resolver = "2"

[profile.release]
codegen-units = 1 # better optimizations
debug = 2 # symbols are nice and they don't increase the size on Flash
lto = true # better optimizations
opt-level = "z" # smaller optimizations

[profile.dev]
opt-level = 1 # no optimizations was just too painful in terms of flash size

[patch."https://github.com/oxidecomputer/hubris".userlib]
path = "sys/userlib"

[patch."https://github.com/oxidecomputer/hubris".abi]
path = "sys/abi"

[workspace.dependencies]
anyhow = "1.0.31"
atty = "0.2"
bitfield = "0.13"
bitflags = "1.2.1"
bstringify = "0.1.2"
byteorder = { version = "1.3.4", default-features = false }
cargo_metadata = "0.12.0"
cfg-if = "1"
clap = { version = "3.0.14", features = ["derive"] }
colored = "2.0"
convert_case = "0.4"
cortex-m = {version = "0.7", features = ["inline-asm"]}
cortex-m-rt = "0.6.12"
ctrlc = "3.1.5"
digest = "0.10"
dunce = "1.0.2"
ecdsa = { version = "0.12.4", default-features = false, features = ["der"] }
filetime = "0.2.12"
fnv = "1.0.7"
goblin = { version = "0.4.3", features = ["std", "elf32", "endian_fd"] }
hmac = { version = "0.10.1", default-features = false }
hubpack = "0.1"
indexmap = { version = "1.4.0", features = ["serde-1"] }
lpc55-pac = { version = "0.4" }
memchr = "2.4"
multimap = "0.8.3"
nb = "1"
num-traits = { version = "0.2.12", default-features = false }
p256 = { version = "0.9.0", default-features = false, features = ["ecdsa", "ecdsa-core"] }
panic-halt = "0.2.0"
panic-itm = "0.4.1"
panic-semihosting = "0.5.3"
paste = "1"
path-slash = "0.1.3"
proc-macro2 = "1"
quote = "1"
rand = "0.8"
rand_chacha = "0.3"
ron = "0.7"
scroll = "0.10"
serde = { version = "1.0.114", default_features = false, features = ["derive"] }
serde_json = "1.0"
sha2 = { version = "0.9", default-features = false }
sha3 = { version = "0.10", default-features = false }
srec = "0.2.0"
ssmarshal = { version = "1.0.0", default-features = false }
static_assertions = { version = "1" }
stm32f3 = "0.13.0"
stm32f4 = "0.13.0"
stm32h7 = { version = "0.14", default-features = false }
strsim = "0.10.0"
syn = { version = "1", features = ["parsing"] }
toml = "0.5.6"
walkdir = "2.0.0"
zerocopy = "0.6.1"

# Oxide forks and repos
salty = { git = "https://github.com/oxidecomputer/salty", rev = "eb3c31858f631a7fb9934246c8efdef080d05726" }
stm32g0 = { git = "https://github.com/oxidecomputer/stm32-rs-nightlies", branch = "stm32g0b1-initial-support", default-features = false }
ordered-toml = { git = "https://github.com/oxidecomputer/ordered-toml" }
tlvc = { git = "https://github.com/oxidecomputer/tlvc" }
tlvc-text = { git = "https://github.com/oxidecomputer/tlvc" }
lpc55_sign = { git = "https://github.com/oxidecomputer/lpc55_support", rev = "5fe64fda52c218cd8d7b31f95a445d8d4ce2cb23" }
lpc55_areas = { git = "https://github.com/oxidecomputer/lpc55_support", rev = "5fe64fda52c218cd8d7b31f95a445d8d4ce2cb23" }
idol = { git = "https://github.com/oxidecomputer/idolatry.git" }
idol-runtime = { git = "https://github.com/oxidecomputer/idolatry.git" }
